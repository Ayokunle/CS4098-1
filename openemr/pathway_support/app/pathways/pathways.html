<html ng-app="popupApp">
        <head>
                <link href="/openemr/pathway_support/css/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css" />
                <link href="/openemr/pathway_support/css/stylesheets/print.css" media="print" rel="stylesheet" type="text/css" />
                <!--[if IE]>
                        <link href="test/stylesheets/ie.css" media="screen, projection" rel="stylesheet" type="text/css" />
                <![endif]-->

                <link href="/openemr/pathway_support/css/stylesheets/pathways.css" rel="stylesheet" type="text/css" />

                <link href="/openemr/pathway_support/css/stylesheets/popup.css" rel="stylesheet" type="text/css" />

                <script src="/openemr/library/js/jquery-2.1.3.min.js"></script>
                <script src="/openemr/library/js/raphael-min.js"></script>
                <script src="/openemr/library/js/raphael-addons.js"></script>

                <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.js"></script>
                <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular-sanitize.js"></script>
                <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0rc1/angular-route.js"></script>
                <script src="pathwaycontroller.js"></script>
                <script src="../actions/actionsDirective.js"></script>
                <script src="graphcontroller.js"></script>

                <script src="popup.js"></script>
        </head>
<body>
<div ng-controller="pathwaycontroller">

        <!-- Pathway selection screen -->
        <div class="pathway container" ng-show="ispathwayselectscreen()">
                <h1>Pathways</h1>
                <p>Active patient id: {{active_pid}}</p>
                <div ng-repeat="pathway in pathways track by $index">
                        <div class="pathwaycontainer ag1">
                                <div class="pathway ag1" ng-click="selectpathway($index)">{{getmodelname(pathway)}}</div>
                                <div class="pathway ag2">
                                        <button ng-click="opengraph(pathway)">Pathway View</button>
                                </div>
                                <div class="pathway ag3">
                                        <button ng-click="deletepathway(pathway)">Delete</button>
                                </div>
                        </div>
                </div>
                <div>
                        <button ng-hide="iscreatingpathway" ng-click="openpathwaycreate()">+</button>
                        <div class="pathwaycreate container" ng-show="iscreatingpathway">
                                <div>Choose a pml model</div>
                                <select ng-model="selectedpml" ng-options="pml for pml in pmlfiles"></select>
                                <div ng-show="pmlfiles.length > 0">
                                        <button ng-click="createpathway(selectedpml)">Ok</button>
                                        <button ng-click="closepathwaycreate()">Cancel</button>
                                </div>
                        </div>
                </div>
        </div>

        <!-- Pathway Notifications screen -->
        <div class="popup container" ng-controller="actionController" ng-show="ispathwaynotifyscreen()">
                <h1>Pathway Actions</h1>

                <div class="ag1">
                        <div ng-controller = "actionController" ng-repeat = "action in pathways[selectedpathway]['action']" class = "action {{ action['@state'] }}">
                                <div class="expanded" ng-show = "visible">
                                        <div><button ng-click="expand()" >Collapse</button></div>
                                        <div>State: {{ action["@state"] }}</div>
                                        <br>
                                        <div>Required resources: {{ action.req_resource["@name"] }}</div>
                                        <br>
                                        <!--div>Provided resources: {{ actionList.provided_resources }}</div-->
                                        <br>

                                        <actionbuttons action="action"></actionbuttons>
                                </div>
                                <div class="collapsed" ng-hide = "visible">
                                        <div><button ng-click="expand()" >Expand</button></div>
                                        {{ action["@name"] }}
                                </div>
                        </div>
                </div>
                <div>
                        <button ng-click="openpathwayselect()">< Back to pathway List</button>
                </div>
        </div>

        <!-- Graph View Screen -->
        <div class="container" ng-controller="graphcontroller" ng-show="ispathwaygraphscreen()">
                <h1>Pathway Graph</h1>
                <div>
                        <div id="graphtag"></div>
                        <button ng-click="openpathwayselect()">< Back to pathway List</button>
                </div>
        </div>
</div>
</body>
</html>